SELECT *,
	CASE
		WHEN age BETWEEN 0 AND 18 THEN 'до 18 лет'
		WHEN age BETWEEN 19 AND 25 THEN '19-25 лет'
		WHEN age BETWEEN 26 AND 35 THEN '26-35 лет'
		WHEN age BETWEEN 36 AND 45 THEN '36-45 лет'
		WHEN age BETWEEN 46 AND 60 THEN '46-60 лет'
		WHEN age >=61 THEN 'более 60 лет'
		ELSE 'категория не определена' --для выявления людей, у которых возраст менее 0
		END AS категория_возраста,
	AVG(daily_phone_hours) OVER (PARTITION BY gender) AS среднее_экранное_время_по_полу
FROM smartphone
ORDER BY user_id;
